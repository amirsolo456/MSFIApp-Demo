<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:local="clr-namespace:MSFIApp.Components.Controls"
             x:Class="MSFIApp.Components.Controls.ExpansionPannel"
             x:Name="ExpandRoot">

    <VerticalStackLayout>
        <toolkit:Expander x:Name="MainExpander" 
                          ExpandedChanged="MainExpander_ExpandedChanged">
            
            <toolkit:Expander.Header>
                <Grid HeightRequest="20" ColumnDefinitions="*,20">

                    <local:IconLabel Text="{Binding HeaderText}"
                                     x:Name="MyIconButton"
                                     Grid.Column="0"                                   
                                     FontAttributes="Bold" 
                                     FontSize="18"
                                     IconSource="{Binding IconSource}"/>
                                     
                    <local:CaretSwitch x:Name="Caret" 
                                       Grid.Column="1"/>
                </Grid>
              
            </toolkit:Expander.Header >
            
            <toolkit:Expander.Content>
                <CollectionView ItemsSource="{Binding Items}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Label Text="{Binding Text}">
                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer 
                                        Command="{Binding BindingContext.ClickCommand, Source={x:Reference Name=ExpandRoot}}" 
                                        CommandParameter="{Binding .}" />
                                </Label.GestureRecognizers>
                            </Label>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </toolkit:Expander.Content>
        </toolkit:Expander>
    </VerticalStackLayout>
</ContentView>
